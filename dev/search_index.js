var documenterSearchIndex = {"docs":
[{"location":"guide/#User-Guide","page":"Getting Started","title":"User Guide","text":"","category":"section"},{"location":"guide/","page":"Getting Started","title":"Getting Started","text":"This guide provides comprehensive instructions for using EntrapmentAnalyses.jl in your proteomics workflows.","category":"page"},{"location":"guide/#Installation","page":"Getting Started","title":"Installation","text":"","category":"section"},{"location":"guide/","page":"Getting Started","title":"Getting Started","text":"EntrapmentAnalyses.jl requires Julia 1.10 or later. Navigate to the EntrapmentAnalyses directory. Use ] to enter Pkg mode. ","category":"page"},{"location":"guide/","page":"Getting Started","title":"Getting Started","text":"\n(@v1.11) pkg> activate .\n  Activating project at `~/Projects/EntrapmentAnalysesJmod/EntrapmentAnalyses`\n\njulia> using Revise, EntrapmentAnalyses\nPrecompiling EntrapmentAnalyses...\n  1 dependency successfully precompiled in 6 seconds. 273 already precompiled.","category":"page"},{"location":"guide/#Input-Data-Requirements","page":"Getting Started","title":"Input Data Requirements","text":"","category":"section"},{"location":"guide/#PSM-Results-(Parquet-Format)","page":"Getting Started","title":"PSM Results (Parquet Format)","text":"","category":"section"},{"location":"guide/","page":"Getting Started","title":"Getting Started","text":"Your PSM results file should contain the following columns:","category":"page"},{"location":"guide/","page":"Getting Started","title":"Getting Started","text":"stripped_seq: Peptide sequence without modifications (String)\nz: Precursor charge state (Integer)\nPredVal: Prediction score from your search engine (Float)\ndecoy: Boolean flag indicating decoy status (Bool)\nchannel: Integer unique to a tag plex \nfile_name: Identifier for the source file (String)","category":"page"},{"location":"guide/#Spectral-Library-(TSV-Format)","page":"Getting Started","title":"Spectral Library (TSV Format)","text":"","category":"section"},{"location":"guide/","page":"Getting Started","title":"Getting Started","text":"The spectral library should contain:","category":"page"},{"location":"guide/","page":"Getting Started","title":"Getting Started","text":"PeptideSequence: Modified peptide sequence (String)\nPrecursorCharge: Charge state (Integer)\nEntrapmentGroupId: 0 for original peptides, >0 for entrapments (Integer)\nPrecursorIdx: Unique identifier linking original/entrapment pairs (Integer)","category":"page"},{"location":"guide/#Basic-Usage","page":"Getting Started","title":"Basic Usage","text":"","category":"section"},{"location":"guide/#Precursor-Level-Analysis","page":"Getting Started","title":"Precursor-Level Analysis","text":"","category":"section"},{"location":"guide/","page":"Getting Started","title":"Getting Started","text":"using EntrapmentAnalyses\n\n# Single file analysis\nresults = run_efdr_analysis(\n    [\"data/search_results.parquet\"],\n    \"data/spectral_library.tsv\"\n)\n\n# Multiple file analysis\nresults = run_efdr_analysis(\n    [\"data/run1.parquet\", \"data/run2.parquet\", \"data/run3.parquet\"],\n    \"data/spectral_library.tsv\";\n    output_dir=\"results/efdr_analysis\"\n)","category":"page"},{"location":"api/#API-Reference","page":"API Reference","title":"API Reference","text":"","category":"section"},{"location":"api/#Main-API-Functions","page":"API Reference","title":"Main API Functions","text":"","category":"section"},{"location":"api/","page":"API Reference","title":"API Reference","text":"This is the primary function for running EFDR analyses:","category":"page"},{"location":"api/#EntrapmentAnalyses.run_efdr_analysis","page":"API Reference","title":"EntrapmentAnalyses.run_efdr_analysis","text":"run_efdr_analysis(parquet_files::Vector{String}, library_path::String; kwargs...)\n\nRun empirical FDR analysis at the precursor level.\n\nThe function modifies the results DataFrame by adding pairing information columns:\n\nis_original: Boolean indicating if peptide is original (true) or entrapment (false)\npair_id: Integer ID linking original/entrapment pairs\nentrap_label: Integer label (0=original, 1=entrapment) for EFDR\ncomplement_score: Plex-specific score of the paired peptide\ncomplement_indices: Deprecated column for backward compatibility\n\nArguments\n\nparquet_files: Vector of paths to Parquet files with PSM results\nlibrary_path: Path to TSV file with spectral library\n\nKeyword Arguments\n\noutput_dir: Output directory (default: \"efdr_output\")\nscore_col: Score column name (default: :PredVal)\nglobal_qval_threshold: Global q-value filter threshold (default: 1.0 = no filter)\nlocal_qval_threshold: Local q-value filter threshold (default: 0.05)\nr_lib: Library to real entrapment ratio (default: 1.0)\nshow_progress: Show progress bars (default: true)\n\nReturns\n\nDataFrame with EFDR columns added\n\n\n\n\n\n","category":"function"},{"location":"api/#Data-Loading","page":"API Reference","title":"Data Loading","text":"","category":"section"},{"location":"api/","page":"API Reference","title":"API Reference","text":"Functions for loading input data:","category":"page"},{"location":"api/#EntrapmentAnalyses.load_parquet","page":"API Reference","title":"EntrapmentAnalyses.load_parquet","text":"load_parquet(filepath::String)\n\nLoad a single Parquet file containing PSM results.\n\nArguments\n\nfilepath: Path to the Parquet file\n\nReturns\n\nDataFrame with PSM results\n\n\n\n\n\n","category":"function"},{"location":"api/#EFDR-Calculation","page":"API Reference","title":"EFDR Calculation","text":"","category":"section"},{"location":"api/","page":"API Reference","title":"API Reference","text":"Core EFDR calculation method:","category":"page"},{"location":"api/#Q-value-Calculation","page":"API Reference","title":"Q-value Calculation","text":"","category":"section"},{"location":"api/","page":"API Reference","title":"API Reference","text":"Functions for q-value computation:","category":"page"},{"location":"api/#EntrapmentAnalyses.calculate_qvalues!","page":"API Reference","title":"EntrapmentAnalyses.calculate_qvalues!","text":"calculate_qvalues!(df::AbstractDataFrame; score_col=:PredVal, decoy_col=:decoy, sort_df=true)\n\nCalculate local q-values and add to DataFrame.\n\nArguments\n\ndf: DataFrame to process\nscore_col: Score column name\ndecoy_col: Decoy column name  \nsort_df: Whether to sort the DataFrame (default: true)\n\n\n\n\n\n","category":"function"},{"location":"api/#EntrapmentAnalyses.calculate_qvalues_per_file!","page":"API Reference","title":"EntrapmentAnalyses.calculate_qvalues_per_file!","text":"calculate_qvalues_per_file!(df::AbstractDataFrame; score_col=:PredVal, file_col=:file_name)\n\nCalculate q-values separately for each file in the dataframe. Adds :localqvalue and :globalqvalue columns.\n\nArguments\n\ndf: DataFrame with PSM results\nscore_col: Score column name (default: :PredVal)\nfile_col: File identifier column (default: :file_name)\n\n\n\n\n\n","category":"function"},{"location":"api/#EntrapmentAnalyses.calculate_global_qvalues!","page":"API Reference","title":"EntrapmentAnalyses.calculate_global_qvalues!","text":"calculate_global_qvalues!(df::AbstractDataFrame; score_col=:PredVal)\n\nCalculate global q-values (best per precursor). Adds :global_qvalue column to the dataframe.\n\n\n\n\n\n","category":"function"},{"location":"api/#EntrapmentAnalyses.monotonize!","page":"API Reference","title":"EntrapmentAnalyses.monotonize!","text":"monotonize!(values::AbstractVector{T}) where T<:AbstractFloat\n\nEnsure FDR values are monotonically non-decreasing. Works in-place by traversing backwards through sorted results.\n\nAlgorithm\n\nStarting from the end (worst scores), ensures each FDR is at least as large as the FDR of better-scoring results.\n\n\n\n\n\nmonotonize!(values::AbstractVector{Union{Missing, T}}) where T<:AbstractFloat\n\nHandle missing values in monotonization.\n\n\n\n\n\n","category":"function"},{"location":"api/#Pairing-System","page":"API Reference","title":"Pairing System","text":"","category":"section"},{"location":"api/","page":"API Reference","title":"API Reference","text":"Functions for computing peptide pairings:","category":"page"},{"location":"api/#EntrapmentAnalyses.compute_pairing_vectors!","page":"API Reference","title":"EntrapmentAnalyses.compute_pairing_vectors!","text":"compute_pairing_vectors!(library_df::DataFrame, results_df::DataFrame; kwargs...)\n\nAdd plex-aware pairing information directly to the results DataFrame.\n\nModifies results_df by adding the following columns:\n\n:is_original - Bool: true if peptide is original, false if entrapment\n:pair_id - Int: ID linking original/entrapment pairs from library\n:entrap_label - Int: 0 for original, 1 for entrapment (used in EFDR)\n:complement_score - Float32: plex & file-specific score of paired peptide (-1 if no pair)\n:complement_indices - Int: deprecated, always -1 (kept for compatibility)\n\nThe complement scores respect both file and plex boundaries, meaning the same peptide in different plexes can have different complement scores.\n\nArguments\n\nlibrary_df: Library DataFrame with entrapment pairs\nresults_df: Results DataFrame to modify (must have file_name and channel columns)\n\nKeyword Arguments\n\nlib_seq_col: Library sequence column (default: :PeptideSequence)\nlib_charge_col: Library charge column (default: :PrecursorCharge)\nlib_entrap_col: Library entrapment group column (default: :EntrapmentGroupId)\nlib_pair_col: Library pair ID column (default: :PrecursorIdx)\nresults_seq_col: Results sequence column (default: :stripped_seq)\nresults_charge_col: Results charge column (default: :z)\nchannel_col: Channel/plex column (default: :channel)\nscore_col: Score column (default: :PredVal)\nfile_col: File name column (default: :file_name)\nshow_progress: Show progress bars (default: true)\n\nReturns\n\nModified results_df with new columns added\n\n\n\n\n\n","category":"function"},{"location":"api/#Visualization","page":"API Reference","title":"Visualization","text":"","category":"section"},{"location":"api/","page":"API Reference","title":"API Reference","text":"Functions for generating plots and reports:","category":"page"},{"location":"api/#EntrapmentAnalyses.plot_combined_efdr","page":"API Reference","title":"EntrapmentAnalyses.plot_combined_efdr","text":"plot_combined_efdr(df::DataFrame; kwargs...)\n\nCreate a plot showing only the combined EFDR results.\n\nArguments\n\ndf: DataFrame with EFDR results\noutput_path: Output file path (default: \"combined_efdr.pdf\")\nfdr_col: FDR column name (default: :local_qvalue)\nefdr_col: EFDR column name (default: :combinedentrapmentfdr)\n\n\n\n\n\n","category":"function"},{"location":"api/#EntrapmentAnalyses.plot_paired_efdr","page":"API Reference","title":"EntrapmentAnalyses.plot_paired_efdr","text":"plot_paired_efdr(df::DataFrame; kwargs...)\n\nCreate a plot showing only the paired EFDR results.\n\nArguments\n\ndf: DataFrame with EFDR results\noutput_path: Output file path (default: \"paired_efdr.pdf\")\nfdr_col: FDR column name (default: :local_qvalue)\nefdr_col: EFDR column name (default: :pairedentrapmentfdr)\n\n\n\n\n\n","category":"function"},{"location":"api/#EntrapmentAnalyses.plot_efdr_comparison_both_methods","page":"API Reference","title":"EntrapmentAnalyses.plot_efdr_comparison_both_methods","text":"plot_efdr_comparison_both_methods(df::DataFrame; kwargs...)\n\nCreate a comparison plot showing both combined and paired EFDR methods.\n\nArguments\n\ndf: DataFrame with both combined and paired EFDR results\noutput_path: Output file path (default: \"efdrcomparisonboth_methods.pdf\")\nfdr_col: FDR column name (default: :local_qvalue)\ncombined_efdr_col: Combined EFDR column name (default: :combinedentrapmentfdr)\npaired_efdr_col: Paired EFDR column name (default: :pairedentrapmentfdr)\n\n\n\n\n\n","category":"function"},{"location":"api/#EntrapmentAnalyses.generate_analysis_report","page":"API Reference","title":"EntrapmentAnalyses.generate_analysis_report","text":"generate_analysis_report(df::DataFrame, output_dir::String; kwargs...)\n\nGenerate a markdown report with embedded plots and analysis summary.\n\nArguments\n\ndf: DataFrame with EFDR results\noutput_dir: Directory to save report and plots\npaired_df: Optional DataFrame with paired EFDR results (if calculated separately)\n\n\n\n\n\n","category":"function"},{"location":"api/#Type-Definitions","page":"API Reference","title":"Type Definitions","text":"","category":"section"},{"location":"api/","page":"API Reference","title":"API Reference","text":"Key types used throughout the package:","category":"page"},{"location":"api/#Index","page":"API Reference","title":"Index","text":"","category":"section"},{"location":"api/","page":"API Reference","title":"API Reference","text":"","category":"page"},{"location":"#EntrapmentAnalyses.jl","page":"Home","title":"EntrapmentAnalyses.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"(Image: Build Status) (Image: codecov)","category":"page"},{"location":"","page":"Home","title":"Home","text":"EntrapmentAnalyses.jl is a Julia package that implementsw that combined and paired empirical FDR (EFDR) methods from Wen et al. 2025","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Navigate to the EntrapmentAnalyses directory. Use ] to enter Pkg mode. ","category":"page"},{"location":"","page":"Home","title":"Home","text":"\n(@v1.11) pkg> activate .\n  Activating project at `~/Projects/EntrapmentAnalysesJmod/EntrapmentAnalyses`\n\njulia> using Revise, EntrapmentAnalyses\nPrecompiling EntrapmentAnalyses...\n  1 dependency successfully precompiled in 6 seconds. 273 already precompiled.","category":"page"},{"location":"#Quick-Start","page":"Home","title":"Quick Start","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"using EntrapmentAnalyses\n\n# Run precursor-level EFDR analysis\nresults = run_efdr_analysis(\n    [\"data/psm_results.parquet\"],\n    \"data/spectral_library.tsv\";\n    output_dir=\"output\"\n)","category":"page"},{"location":"#Documentation-Contents","page":"Home","title":"Documentation Contents","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"guide.md\", \"api.md\"]\nDepth = 2","category":"page"},{"location":"#Workflow","page":"Home","title":"Workflow","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Load PSM results and spectral library data\nCompute peptide pairings with plex-aware complement scoring\nCalculate per-file q-values\nPerform EFDR analysis (combined and/or paired)\nGenerate visualizations and reports\nOptional: Perform protein-level analysis","category":"page"}]
}
